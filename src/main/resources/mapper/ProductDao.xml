<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cdq.o2o.dao.ProductDao">
    <insert id="insertProduct" parameterType="com.cdq.o2o.entity.Product" useGeneratedKeys="true"
            keyProperty="productId" keyColumn="product_id">
        insert into tb_product(
        product_name,product_desc,img_addr,normal_price,promotion_price,
        priority,create_time,last_edit_time,enable_status,product_category_id,shop_id
        ) values(
        #{productName},#{productDesc},#{imgAddr},#{normalPrice},
        #{promotionPrice},#{priority},#{createTime},#{lastEditTime},
        #{enableStatus},#{productCategory.productCategoryId},#{shop.shopId}
        )
    </insert>
    <!--通过shopId查询商品列表-->
    <select id="queryProductList" resultType="com.cdq.o2o.entity.Product" parameterType="Long" >
        select
        product_id,
        product_name,
        product_desc,
        img_addr,
        normal_price,
        promotion_price,
        priority,
        create_time,
        last_edit_time,
        enable_status,
        point,
        product_category_id,
        shop_id
        from tb_product
        where shop_id=#{shopId}
        order by priority desc;
    </select>
    <!--通过productId查询商品信息-->
    <select id="queryProductByProductId" resultType="com.cdq.o2o.entity.Product" parameterType="Long">
        <!-- 具体的sql -->
        select
        p.product_id,
        p.product_name,
        p.product_desc,
        p.img_addr,
        p.normal_price,
        p.promotion_price,
        p.priority,
        p.create_time,
        p.last_edit_time,
        p.enable_status,
        p.point,
        p.product_category_id,
        p.shop_id
        from tb_product p
        where p.product_id=#{productId}
        order by p.priority desc;
    </select>
</mapper>